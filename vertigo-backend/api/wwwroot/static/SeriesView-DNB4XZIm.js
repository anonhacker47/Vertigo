import{ay as U,aH as ee,aQ as te,aR as se,az as p,o as c,c as u,au as oe,a as e,k as h,T as d,a2 as m,u as V,aS as q,aD as M,aT as J,aL as le,aM as ae,aN as re,aF as ne,aO as ie,l as y,aP as de,F as E,j as F,W as H,aU as ce,aV as ue,r as Z,t as fe,S as T,aB as me}from"./index-DN0zppBt.js";import{_ as pe,a as ge}from"./remove-CRQUvavr.js";import{S as A}from"./SeriesService-Cc07SvbQ.js";import{I}from"./IssueService-kkG25aKm.js";const ve="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20fill='none'%20id='love'%3e%3cpath%20fill='%2322ffb5'%20d='M4.379%2012.274A4.841%204.841%200%200%201%203%208.89C3%206.189%205.216%204%207.95%204c1.674%200%203.154.82%204.05%202.077A4.962%204.962%200%200%201%2016.05%204C18.784%204%2021%206.189%2021%208.889a4.845%204.845%200%200%201-1.507%203.512L12%2020l-7.621-7.726Z'%3e%3c/path%3e%3c/svg%3e",_e={class:"absolute inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center px-3"},xe={class:"text-white text-2xl font-semibold text-center leading-snug tracking-wide"},he={class:"space-y-1 text-white text-sm font-semibold px-2 py-2"},be={class:"flex flex-col gap-1"},we={class:"truncate"},ye={key:0,class:"flex flex-col gap-1 border-b border-zinc-700 pb-2"},$e={class:"truncate ml-1 justify-center items-center flex text-emerald-500 text-xl"},ke={class:"truncate"},Ce=["value"],Ie={class:"flex flex-col gap-1"},Se={class:"truncate"},je=U({__name:"IssueCarditem",props:{image:String,themecolor:String,title:String,is_owned:Boolean,is_read:Boolean,bought_date:Date,read_date:Date,bought_price:Number,preferred_currency:String,is_last:Boolean,edit_mode:Boolean},emits:["updateStatus","updateDate","deleteIssue"],setup(n,{emit:S}){const f=n,v=ee(()=>f.edit_mode);te(v,(l,o)=>{console.log("editMode changed:",o,"â†’",l)});const R=se(f.preferred_currency);function j(l){return new Date(l).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}const $=p(!1),k=p(!1),C=p(!1);function B(){C.value=!0}function b(l){const o=parseFloat(l.target.value);i("updateStatus",{status:"bought_price",value:o}),C.value=!1}const i=S;function g(l){l==="is_owned"&&!f.is_owned?$.value=!0:l==="is_read"&&!f.is_read?k.value=!0:i("updateStatus",{status:l,value:!1})}function D(l,o){const a=o.target.value;i("updateStatus",{status:l,value:!0,date:a}),l==="is_owned"?$.value=!1:l==="is_read"&&(k.value=!1)}return(l,o)=>(c(),u("div",{class:V([{"animate-wiggle":v.value&&n.is_last},"w-44 h-64 flex relative flex-col rounded-lg border-2 overflow-hidden shadow-lg bg-zinc-900"]),style:m(`border-color: rgb${n.themecolor};`)},[v.value&&n.is_last?(c(),u("div",{key:0,onClick:o[0]||(o[0]=oe(a=>l.$emit("deleteIssue"),["prevent"])),class:"absolute top-0 right-0 rounded hover:scale-105 hover:rotate-180 z-[800] transition ease-in-out"},o[5]||(o[5]=[e("img",{src:pe,alt:"",height:"30",width:"30",class:"min-w-[25px] min-h-[25px]"},null,-1)]))):h("",!0),e("div",{class:"h-[70%] w-full bg-cover bg-center relative",style:m(`background-image: url(${n.image})`)},[e("div",_e,[e("p",xe," Vol. "+d(n.title),1)])],4),e("div",he,[e("div",be,[e("div",{class:"flex items-center gap-2 cursor-pointer hover:bg-zinc-700 px-2 py-1 rounded transition-all",onClick:o[1]||(o[1]=a=>g("is_owned"))},[e("img",{class:V([n.is_owned?"opacity-100":"invert","w-6 h-6"]),src:q,alt:"Owned"},null,2),e("span",we,d(n.is_owned?n.bought_date?""+j(n.bought_date):"Owned":"Not Owned"),1)]),$.value?(c(),u("input",{key:0,type:"date",class:"bg-zinc-800 text-white rounded px-2 py-1",onChange:o[2]||(o[2]=a=>D("is_owned",a))},null,32)):h("",!0)]),n.is_owned?(c(),u("div",ye,[e("div",{class:"flex items-center gap-3 cursor-pointer hover:bg-zinc-700 px-2 py-1 rounded transition-all",onClick:B},[e("span",$e,d(M(R)),1),e("span",ke,d(f.bought_price!==null?`${f.bought_price}`:"Add Price"),1)]),C.value?(c(),u("input",{key:0,type:"number",min:"0",step:"0.01",placeholder:"Enter Price",class:"bg-zinc-800 text-white rounded px-2 py-1",onChange:b,value:f.bought_price??""},null,40,Ce)):h("",!0)])):h("",!0),e("div",Ie,[e("div",{class:"flex items-center gap-2 cursor-pointer hover:bg-zinc-700 px-2 py-1 rounded transition-all",onClick:o[3]||(o[3]=a=>g("is_read"))},[e("img",{class:V([n.is_read?"opacity-100":"invert","w-6 h-6"]),src:J,alt:"Read"},null,2),e("span",Se,d(n.is_read?n.read_date?""+j(n.read_date):"Read":"Not Read"),1)]),k.value?(c(),u("input",{key:0,type:"date",class:"bg-zinc-800 text-white rounded px-2 py-1",onChange:o[4]||(o[4]=a=>D("is_read",a))},null,32)):h("",!0)])])],6))}}),De={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",id:"edit"},ze={"data-name":"81 Edit"},Le=["fill"],Ne=["fill"],G=U({__name:"EditIcon",props:{fillColor:String},setup(n){return(S,f)=>(c(),u("svg",De,[e("g",ze,[e("path",{fill:n.fillColor,d:"M24,29.5H6A3.5,3.5,0,0,1,2.5,26V8A3.5,3.5,0,0,1,6,4.5h9a1.5,1.5,0,0,1,0,3H6a.5.5,0,0,0-.5.5V26a.5.5,0,0,0,.5.5H24a.5.5,0,0,0,.5-.5V17a1.5,1.5,0,0,1,3,0v9A3.5,3.5,0,0,1,24,29.5Z"},null,8,Le),e("path",{fill:n.fillColor,d:"M12,21.5a1.5,1.5,0,0,1-1.49-1.69l.56-4.36a1.52,1.52,0,0,1,.42-.87L22.35,3.73a4.19,4.19,0,1,1,5.92,5.92L17.42,20.51a1.52,1.52,0,0,1-.87.42l-4.36.56Zm4.36-2.05h0ZM14,16.34l-.25,1.93L15.66,18,26.15,7.53a1.18,1.18,0,0,0,0-1.68,1.21,1.21,0,0,0-1.68,0Z"},null,8,Ne)])]))}}),Ve={class:"flex flex-col min-h-screen min-w-screen",style:{background:"rgba(18,25,43,0.90)"}},Me={class:"flex flex-col md:flex-row md:justify-between justify-center items-center py-4 px-4 border-b gap-4 border-slate-700 flex-wrap"},Re={class:"flex flex-1 justify-center md:justify-start items-center px-5 md:w-1/3 break-words"},Be={class:"flex flex-1 justify-center items-center md:w-1/4 gap-5"},Pe={class:"tooltip tooltip-success tooltip-bottom","data-tip":"Number of Issues"},Ee={class:"flex flex-row items-center"},Fe={class:"pl-2 text-primary font-bold text-lg"},Ae={class:"tooltip tooltip-success tooltip-bottom","data-tip":"Collected"},Ue={class:"flex flex-row items-center"},Oe={class:"pl-2 text-primary font-bold text-lg"},He={class:"tooltip tooltip-success tooltip-bottom","data-tip":"Read"},Ze={class:"flex flex-row items-center"},Te={class:"pl-2 text-primary font-bold text-lg"},Ge={class:"flex flex-1 justify-center md:justify-end items-center w-1/3"},qe={class:"flex flex-col md:flex-row grow"},Je={class:"flex flex-col mb-6 mr-2 md:basis-1/2 md:w-1/2 w-full"},Ke={class:"flex flex-col md:flex-row pt-8 basis-1/2 shrink-0 relative gap-4"},Qe={class:"flex flex-col basis-1/3 px-28 md:px-4"},We=["src"],Xe={class:"text-sm font-bold"},Ye={class:"flex flex-col basis-2/3 shrink-0 overflow-scroll gap-4"},et={class:"flex flex-col md:flex-row justify-center md:justify-start items-center gap-4"},tt={class:"flex flex-col md:flex-row justify-center md:justify-start items-center gap-4"},st={class:"flex flex-row gap-4 max-w-md justify-center md:justify-start overflow-scroll whitespace-nowrap flex-wrap"},ot={class:"flex flex-col md:flex-row items-center gap-4"},lt={class:"flex flex-col md:flex-row items-center max-w-full gap-4"},at={class:"flex flex-row gap-4 overflow-scroll whitespace-nowrap justify-center md:justify-start flex-wrap md:flex-no"},rt={class:"flex flex-col relative shrink-0"},nt={class:"mx-8 my-5"},it={class:"mt-4 text-justify"},dt={class:"relative flex flex-col w-full items-center justify-evenly md:basis-1/2 md:w-1/2 shrink-0 border-l border-slate-700 mb-6"},ct={class:"overflow-scroll h-full flex flex-row justify-center items-start w-full"},ut={class:"flex flex-wrap flex-start items-start gap-10 md:px-16 px-12"},ft={class:"font-bold"},mt={class:"text-red-500"},pt=U({__name:"SeriesView",setup(n){const S=le(),f=ae(),v=p();async function R(){try{const s=await I.createIssue(Number(b.params.Id));P(),z(),f.add({severity:"success",summary:"Success",detail:`Issue ${s.data.title} added`,life:3e3})}catch(s){v.value=s,f.add({severity:"error",summary:"Error",detail:v.value,life:3e3})}}async function j(s){try{const t=await I.removeIssue(s.id);P(),z()}catch(t){v.value=t,f.add({severity:"error",summary:"Error",detail:v.value,life:3e3})}}const $=s=>{S.require({message:s.title,header:"Confirm Deletion",icon:"pi pi-info-circle",rejectLabel:"Cancel",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Delete",severity:"danger"},accept:()=>{j(s),f.add({severity:"success",summary:"Confirmed",detail:`Issue ${s.title} deleted`,life:3e3})},reject:()=>{}})},k=()=>{l.value=!l.value,console.log("ediotMode",l.value)},C=re(),{preferred_currency:B}=C.getUser(),b=ue(),i=p(null),g=p([]),D=p(),l=p(!1);ne({value:i});const o=p({owned_count:0,read_count:0,total_count:0}),a=p("(212, 222, 252)"),_=p(),K=new URL("/static/dummy-DJ5LijKr.webp",import.meta.url).href;async function O(){try{const s=await A.getSeriesbyId(Number(b.params.Id));i.value=s,a.value=s.dominant_color.slice(0,-1).toString()+s.dominant_color.slice(-1).toString(),i.value&&(_.value=`${A.getImagebyId(i.value.id)}?t=${Date.now()}`,console.log("getSeries",_.value))}catch(s){console.log(s)}}async function P(){try{const s=await I.fetchIssues(Number(b.params.Id),"title","asc");g.value=s.issuesList,g.value=g.value.map(t=>({...t,bought_date:t.bought_date?new Date(t.bought_date):null,read_date:t.read_date?new Date(t.read_date):null})),D.value=s.pagination}catch(s){console.log(s)}}async function z(){try{const s=await I.getIssueCount(Number(b.params.Id));o.value=s.data,console.log(o)}catch(s){console.log(s)}}async function Q(s,t){const{status:w,value:L,date:r}=t;if(s[w]=L,r){const x=w==="is_owned"?"bought_date":"read_date";s[x]=r}try{const x={[w]:L};if(r){const X=w==="is_owned"?"bought_date":"read_date",Y=new Date(r).toISOString();x[X]=Y}const N=await I.updateIssue(s.id,x);console.log(N.data),z()}catch(x){console.log(x)}}async function W(s){try{const t=new FormData;t.append("user_rating",String(s)),await A.updateSeries(Number(b.params.Id),t),await O(),console.log("Rating updated and series reloaded.")}catch(t){console.error("Failed to update rating:",t)}}return ie(()=>{O(),P(),z()}),(s,t)=>{const w=Z("RouterLink"),L=Z("ConfirmDialog");return i.value?(c(),u("div",{key:0,class:"bg-no-repeat bg-center h-full bg-cover",style:m({backgroundImage:"url("+_.value+")"})},[e("div",Ve,[y(de),e("div",Me,[e("div",Re,[e("p",{class:"font-bold text-3xl truncate",style:m(`color: rgb${a.value}`)},d(i.value.title),5)]),e("div",Be,[e("div",Pe,[e("div",Ee,[t[1]||(t[1]=e("img",{class:"",src:ve,alt:"",width:"28",height:"28"},null,-1)),e("p",Fe,d(o.value.total_count),1)])]),e("div",Ae,[e("div",Ue,[t[2]||(t[2]=e("img",{src:q,alt:"",width:"28",height:"28"},null,-1)),e("p",Oe,d(o.value.owned_count+"/"+o.value.total_count),1)])]),e("div",He,[e("div",Ze,[t[3]||(t[3]=e("img",{src:J,alt:"",width:"28",height:"28"},null,-1)),e("p",Te,d(o.value.read_count+"/"+o.value.total_count),1)])])]),e("div",Ge,[y(M(ge),{"onUpdate:modelValue":W,modelValue:i.value.user_rating,cancel:!1,stars:5},null,8,["modelValue"])])]),e("div",qe,[e("div",Je,[e("div",Ke,[e("div",Qe,[_.value!="noimage"?(c(),u("img",{key:0,src:_.value,alt:"",class:"rounded-lg border-2 max-h-96",style:m(`border-color: rgb${a.value}`),onError:t[0]||(t[0]=r=>_.value=M(K))},null,44,We)):h("",!0),e("div",{class:"flex flex-row items-center justify-center gap-2 mt-2 px-2 py-1 rounded-sm bg-slate-800",style:m(`border-color: rgb${a.value}; color: rgb${a.value}`)},[e("p",Xe,d(i.value.series_format),1)],4)]),e("div",Ye,[e("div",et,[t[4]||(t[4]=e("span",{class:"font-bold text-lg"},"Publisher",-1)),e("span",{class:"text-sm font-bold bg-slate-800 rounded-md px-4 py-1",style:m(`color: rgb${a.value}`)},d(i.value.publisher),5)]),e("div",tt,[t[5]||(t[5]=e("div",{class:"font-bold text-lg"},"Genre",-1)),e("div",st,[(c(!0),u(E,null,F(i.value.genre,r=>(c(),u("p",{class:"bg-slate-800 rounded-md px-4 py-1 text-sm font-bold",style:m(`color: rgb${a.value}`)},d(r),5))),256))])]),e("div",ot,[t[6]||(t[6]=e("span",{class:"font-bold text-lg"},"Main Character/Team",-1)),e("span",{class:"text-sm font-bold bg-slate-800 rounded-md px-4 py-1",style:m(`color: rgb${a.value}`)},d(i.value.main_character),5)]),e("div",lt,[t[7]||(t[7]=e("div",{class:"font-bold text-lg"},"Creators",-1)),e("div",at,[(c(!0),u(E,null,F(i.value.creator,r=>(c(),u("p",{class:"bg-slate-800 flex-shrink rounded-md px-4 h-7 py-1 text-sm font-bold",style:m(`color: rgb${a.value}`)},d(r),5))),256))])])]),y(w,{to:{name:"EditSeries",params:{Link:i.value.slug,Id:i.value.id}},class:"absolute right-0 top-2 cursor-pointer w-12 h-12 transition duration-200 ease-in-out hover:scale-110 hover:border-emerald-400 hover:border-2 rounded-full flex items-center justify-center"},{default:H(()=>[y(G,{class:"w-7 h-7","fill-color":`rgb${a.value}`},null,8,["fill-color"])]),_:1},8,["to"])]),e("div",rt,[e("div",nt,[e("p",{class:"text-xl text-center font-bold",style:m(`color: rgb${a.value}`)}," Description ",4),e("p",it,d(i.value.description),1)])])]),e("div",dt,[e("h1",{class:"flex justify-center pb-4 px-4 font-bold text-3xl",style:m(`color: rgb${a.value}`)}," Issues ",4),e("div",ct,[e("div",ut,[(c(!0),u(E,null,F(g.value,(r,x)=>(c(),fe(je,{edit_mode:l.value,is_last:x===g.value.length-1&&g.value.length>1,preferred_currency:M(B),bought_price:r.bought_price,image:_.value,bought_date:r.bought_date,read_date:r.read_date,themecolor:a.value,title:r.title,is_owned:r.is_owned,is_read:r.is_read,onUpdateStatus:N=>Q(r,N),key:r.id,onDeleteIssue:N=>$(r)},null,8,["edit_mode","is_last","preferred_currency","bought_price","image","bought_date","read_date","themecolor","title","is_owned","is_read","onUpdateStatus","onDeleteIssue"]))),128)),l.value?(c(),u("div",{key:0,onClick:R,class:"w-44 h-64 flex relative flex-col items-center bg-cover bg-center justify-center rounded-lg border-green-500 border-2 overflow-hidden shadow-lg cursor-pointer bg-zinc-800 border-dashed hover:bg-zinc-700 transition-all",style:m(`background-image: url(${_.value})`)},t[8]||(t[8]=[e("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center px-3"},[e("div",{class:"flex flex-col items-center justify-center text-white gap-2"},[e("img",{src:ce,alt:"Add",class:"w-12 h-12 opacity-80"}),e("p",{class:"text-white text-md font-bold"},"Add Issue")])],-1)]),4)):h("",!0)])]),e("button",{onClick:k,class:V(["mt-4 absolute right-2 -top-2 w-12 h-12 cursor-pointer hover:scale-110 rounded-full transition duration-200 ease-in-out hover:border-emerald-400 hover:border-2 flex items-center justify-center",l.value?" border-green-700":" border-zinc-500"])},[y(G,{class:"w-7 h-7",fill:l.value?"white":`rgb${a.value}`},null,8,["fill"])],2)])])]),y(L,null,{message:H(r=>[e("p",ft,[t[9]||(t[9]=T(" Do you really want to delete the Issue ")),e("span",mt,d(r.message.message),1),t[10]||(t[10]=T("? "))])]),_:1})],4)):h("",!0)}}}),ht=me(pt,[["__scopeId","data-v-6adce15b"]]);export{ht as default};
