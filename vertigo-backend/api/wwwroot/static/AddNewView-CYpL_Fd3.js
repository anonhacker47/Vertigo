import{ay as C,aF as B,aQ as $,o as v,c as h,a as e,$ as f,aW as S,aZ as E,l as D,k as _,au as T,az as y,aH as F,u as w,a_ as I,F as M,j as O,T as R,aM as L,a$ as P,aC as H,aB as q}from"./index-DN0zppBt.js";import{I as z}from"./IssueService-kkG25aKm.js";import{S as G}from"./SeriesService-Cc07SvbQ.js";import{_ as j,a as N}from"./MultiSelectCombobox.vue_vue_type_script_setup_true_lang-BC2O8HmQ.js";const J={key:0,class:"card h-full w-full md:w-2/3 flex gap-6 md:gap-10 shadow-2xl bg-base-100 justify-between p-8"},Y={class:"flex flex-col w-full md:flex-row gap-8 md:gap-20 justify-around"},K={class:"form-control w-full"},Q={class:"form-control w-full"},W={class:"form-control w-full"},Z={class:"flex flex-col md:flex-row gap-8 md:gap-20 justify-around"},X={class:"form-control w-full text-center"},ee={key:0,class:"text-sm text-gray-400 mt-1"},te={class:"form-control w-full"},le={class:"form-control w-full text-center"},ae={key:0,class:"text-sm text-gray-400 mt-1"},se={class:"flex flex-col md:flex-row gap-20 justify-around"},oe={class:"form-control w-full"},re={class:"flex flex-col md:flex-row gap-16 justify-around"},ne={class:"form-control w-full"},ue={class:"form-control w-full"},ie=["disabled"],de=C({__name:"CreateSeriesForm",props:{modelValue:{},showIssueSection:{type:Boolean}},emits:["update:modelValue","next"],setup(k,{emit:b}){const g=k,d=b,r=B({...g.modelValue});$(r,s=>{const{thumbnail:o,...t}=s;d("update:modelValue",{...t,thumbnail:g.modelValue.thumbnail})},{deep:!0});const m=()=>{d("next")};return(s,o)=>s.showIssueSection?_("",!0):(v(),h("div",J,[e("div",Y,[e("div",K,[f(e("input",{type:"text",placeholder:"Series Name","onUpdate:modelValue":o[0]||(o[0]=t=>r.title=t),class:"input w-full input-bordered",required:""},null,512),[[S,r.title]])]),e("div",Q,[f(e("select",{class:"select w-full select-primary","onUpdate:modelValue":o[1]||(o[1]=t=>r.series_format=t),required:""},o[8]||(o[8]=[e("option",{disabled:"",value:""},"Pick Format",-1),e("option",null,"Single Issues",-1),e("option",null,"Trade Paperback",-1),e("option",null,"Hard Cover",-1),e("option",null,"Omnibus",-1),e("option",null,"Absolute Edition",-1),e("option",null,"Manga",-1)]),512),[[E,r.series_format]])]),e("div",W,[D(j,{modelValue:r.publisher,"onUpdate:modelValue":o[2]||(o[2]=t=>r.publisher=t),field:"publisher",placeholder:"Publisher"},null,8,["modelValue"])])]),e("div",Z,[e("div",X,[D(N,{modelValue:r.genre,"onUpdate:modelValue":o[3]||(o[3]=t=>r.genre=t),field:"genre",placeholder:"Select Genre(s)"},null,8,["modelValue"]),r.genre.length==0?(v(),h("p",ee,"You can select multiple options")):_("",!0)]),e("div",te,[D(j,{modelValue:r.main_character,"onUpdate:modelValue":o[4]||(o[4]=t=>r.main_character=t),field:"main_character",placeholder:"Main Character/ Team"},null,8,["modelValue"])]),e("div",le,[D(N,{modelValue:r.creator,"onUpdate:modelValue":o[5]||(o[5]=t=>r.creator=t),field:"creator",placeholder:"Select Creator(s)"},null,8,["modelValue"]),r.creator.length==0?(v(),h("p",ae,"You can select multiple options")):_("",!0)])]),e("div",se,[e("div",oe,[f(e("textarea",{class:"textarea textarea-bordered",placeholder:"Summary","onUpdate:modelValue":o[6]||(o[6]=t=>r.description=t)},null,512),[[S,r.description]])])]),e("div",re,[e("div",ne,[e("button",{type:"button",onClick:o[7]||(o[7]=t=>s.$router.push("collection")),class:"btn btn-danger"}," Cancel ")]),e("div",ue,[e("button",{onClick:T(m,["prevent"]),disabled:!r.title||!r.series_format,class:"btn btn-primary rounded"}," Next ",8,ie)])])]))}}),ce={key:0,class:"card h-full w-full md:w-2/3 flex flex-col gap-6 md:gap-8 shadow-2xl bg-base-100 p-8"},me={class:"form-control"},pe={class:"flex flex-col md:flex-row gap-4 md:gap-16 justify-around"},fe={class:"form-control w-full"},ve={class:"form-control w-full"},he={class:"grid place-items-center w-full md:gap-6 md:max-h-[28rem] overflow-y-auto overflow-x-hidden",style:{"grid-template-columns":"repeat(auto-fill, minmax(15rem, 1fr))",gap:"1rem"}},be={class:"relative w-full md:h-52 h-40"},ge=["src"],xe={class:"absolute inset-0 flex items-center justify-center text-white text-3xl font-bold bg-black/50 rounded-md"},we={class:"flex w-full justify-around gap-2 text-sm md:text-md md:gap-4 p-4"},ye=["onUpdate:modelValue"],_e=["onUpdate:modelValue"],Ve={key:0,class:"flex flex-col w-full pb-4 px-4 gap-2 text-sm md:text-md"},De={key:0,class:"flex flex-col"},Se=["onUpdate:modelValue"],$e={key:1,class:"flex flex-col"},ke=["onUpdate:modelValue"],Ae={key:2,class:"flex flex-col"},Ie=["onUpdate:modelValue"],Ue={class:"flex justify-between mt-6"},Ce=["disabled"],je=C({__name:"IssuesForm",props:{showIssueSection:{type:Boolean},seriesData:{},issues:{},readAll:{type:Boolean},haveAll:{type:Boolean},imagesrc:{}},emits:["cancel","submit","update:readAll","update:haveAll","update:issues"],setup(k,{emit:b}){const g=k,d=b,r=y(g.readAll),m=y(g.haveAll),s=F({get:()=>g.issues,set:t=>d("update:issues",t)});$(()=>g.seriesData.issue_count,t=>{d("update:readAll",!1),d("update:haveAll",!1);const a=Array.from({length:t},()=>({read:!1,have:!1,purchaseDate:null,readDate:null,price:null}));d("update:issues",a)},{immediate:!0}),$(s,t=>{const a=new Date().toISOString().split("T")[0];t.forEach(l=>{l.have&&!l.purchaseDate&&(l.purchaseDate=a),l.read&&!l.readDate&&(l.readDate=a)})},{deep:!0});function o(t){const a=[...s.value];a.forEach(l=>{l[t]=t==="read"?r.value:m.value}),d("update:issues",a)}return(t,a)=>t.showIssueSection?(v(),h("div",ce,[e("div",me,[a[7]||(a[7]=e("label",{class:"label",for:"issue-count"},"Number of Issues",-1)),f(e("input",{id:"issue-count",type:"number","onUpdate:modelValue":a[0]||(a[0]=l=>t.seriesData.issue_count=l),min:"1",class:"input input-bordered"},null,512),[[S,t.seriesData.issue_count,void 0,{number:!0}]])]),e("div",pe,[e("div",fe,[e("label",{class:w(["label cursor-pointer flex items-center gap-2",m.value?"text-primary":"text-white"])},[a[8]||(a[8]=e("span",null,"Have All?",-1)),f(e("input",{type:"checkbox","onUpdate:modelValue":a[1]||(a[1]=l=>m.value=l),onChange:a[2]||(a[2]=l=>o("have")),class:w(["checkbox",m.value?"checkbox-primary":""])},null,34),[[I,m.value]])],2)]),e("div",ve,[e("label",{class:w(["label cursor-pointer flex items-center gap-2",r.value?"text-accent":"text-white"])},[a[9]||(a[9]=e("span",null,"Read Already?",-1)),f(e("input",{type:"checkbox","onUpdate:modelValue":a[3]||(a[3]=l=>r.value=l),onChange:a[4]||(a[4]=l=>o("read")),class:w(["checkbox",r.value?"checkbox-accent":""])},null,34),[[I,r.value]])],2)])]),e("div",he,[(v(!0),h(M,null,O(t.seriesData.issue_count,l=>(v(),h("div",{key:l,class:w(["relative card border w-full md:w-fit shadow-md rounded-md flex flex-col items-center",{"border-primary":s.value[l-1].have,"border-accent":s.value[l-1].read}])},[e("div",be,[e("img",{src:t.imagesrc,alt:"Issue Thumbnail",class:"w-full h-full object-cover rounded-md brightness-80 hover:brightness-100 transition duration-300"},null,8,ge),e("p",xe," #"+R(l),1)]),e("div",we,[e("label",{class:w(["cursor-pointer flex items-center gap-2",s.value[l-1].have?"text-primary":"text-white"])},[a[10]||(a[10]=e("span",null,"Have",-1)),f(e("input",{type:"checkbox","onUpdate:modelValue":p=>s.value[l-1].have=p,class:w(["checkbox",s.value[l-1].have?"checkbox-primary":""])},null,10,ye),[[I,s.value[l-1].have]])],2),e("label",{class:w(["cursor-pointer flex items-center gap-2",s.value[l-1].read?"text-green-500":"text-white"])},[a[11]||(a[11]=e("span",null,"Read",-1)),f(e("input",{type:"checkbox","onUpdate:modelValue":p=>s.value[l-1].read=p,class:w(["checkbox",s.value[l-1].read?"checkbox-accent":""])},null,10,_e),[[I,s.value[l-1].read]])],2)]),s.value[l-1].have||s.value[l-1].read?(v(),h("div",Ve,[s.value[l-1].have?(v(),h("label",De,[a[12]||(a[12]=e("span",{class:"text-white"},"Purchase Date",-1)),f(e("input",{type:"date","onUpdate:modelValue":p=>s.value[l-1].purchaseDate=p,class:"input input-bordered w-full"},null,8,Se),[[S,s.value[l-1].purchaseDate]])])):_("",!0),s.value[l-1].read?(v(),h("label",$e,[a[13]||(a[13]=e("span",{class:"text-white"},"Read Date",-1)),f(e("input",{type:"date","onUpdate:modelValue":p=>s.value[l-1].readDate=p,class:"input input-bordered w-full"},null,8,ke),[[S,s.value[l-1].readDate]])])):_("",!0),s.value[l-1].have?(v(),h("label",Ae,[a[14]||(a[14]=e("span",{class:"text-white"},"Price",-1)),f(e("input",{type:"number","onUpdate:modelValue":p=>s.value[l-1].price=p,class:"input input-bordered w-full",step:"0.01"},null,8,Ie),[[S,s.value[l-1].price]])])):_("",!0)])):_("",!0)],2))),128))]),e("div",Ue,[e("button",{class:"btn btn-danger",onClick:a[5]||(a[5]=l=>t.$emit("cancel"))},"Go Back / Cancel"),e("button",{class:"btn btn-primary",disabled:t.seriesData.issue_count<1,onClick:a[6]||(a[6]=T(l=>t.$emit("submit"),["prevent"]))},"Create Series",8,Ce)])])):_("",!0)}}),Ne={autocomplete:"on",class:"z-0 flex items-center justify-evenly flex-1 p-4 gap-6 md:gap-4 md:flex-row flex-col"},Te={class:"w-[24rem] h-[38rem]"},Be=C({__name:"AddNewView",setup(k){const b=y(new URL("/static/dummy-DJ5LijKr.webp",import.meta.url).href);y("");const g=H(),d=L(),r=y(!1),m=y(!1),s=y(!1),o=y([]),t=y({title:"",creator:[],description:"",genre:[],main_character:"",series_format:"",issue_count:1,thumbnail:"",publisher:"",read_count:0,owned_count:0});$(()=>t.value.issue_count,i=>{s.value=!1,m.value=!1,o.value=Array.from({length:i},()=>({read:!1,have:!1,purchaseDate:null,readDate:null,price:null}))},{immediate:!0}),$(o,i=>{i.forEach(n=>{const u=new Date().toISOString().split("T")[0];n.have&&!n.purchaseDate&&(n.purchaseDate=u),n.read&&!n.readDate&&(n.readDate=u)})},{deep:!0});async function a(){var i;if(!t.value.title.trim()){d.add({severity:"warn",summary:"Validation Error",detail:"Title is required.",life:3e3});return}try{const n=o.value.filter(x=>x.have).length,u=o.value.filter(x=>x.read).length;t.value.issue_count=o.value.length;const c={title:t.value.title,publisher:t.value.publisher||"",creator:t.value.creator||[],description:t.value.description||"",genre:t.value.genre||[],main_character:t.value.main_character||"",series_format:t.value.series_format||"",issue_count:t.value.issue_count||0,read_count:u,owned_count:n},V=new FormData;for(const x in c)Array.isArray(c[x])?V.append(x,JSON.stringify(c[x])):V.append(x,((i=c[x])==null?void 0:i.toString())||"");t.value.thumbnail&&V.append("thumbnail",t.value.thumbnail);const A=await G.addSeries(V),U=A==null?void 0:A.id;U?(await l(U),d.add({severity:"success",summary:"Success",detail:"Series created successfully!",life:3e3}),g.push({name:"SeriesDetail",params:{Link:A.slug,Id:U}})):d.add({severity:"error",summary:"Failure",detail:"Series creation failed.",life:3e3})}catch(n){console.error("Error creating series:",n),d.add({severity:"error",summary:"Error",detail:n.message||"Unexpected error.",life:3e3})}}async function l(i){var n;try{if(!o.value.length){console.log("No issues to add.");return}const u=o.value.map((c,V)=>({number:V+1,title:String(V+1),is_owned:c.have,is_read:c.read,bought_date:c.purchaseDate?new Date(c.purchaseDate).toISOString():null,read_date:c.readDate?new Date(c.readDate).toISOString():null,bought_price:c.price||null}));await z.addIssues(i,u),console.log("Issues added successfully!")}catch(u){console.error("Error adding issues:",((n=u.response)==null?void 0:n.data)||u)}}function p(i){t.value.thumbnail=i,i instanceof File?b.value=URL.createObjectURL(i):typeof i=="string"&&(b.value=i),console.log("Image Changed:",t.value.thumbnail)}return(i,n)=>(v(),h("form",Ne,[e("div",Te,[D(P,{modelValue:b.value,"onUpdate:modelValue":n[0]||(n[0]=u=>b.value=u),onImageChange:p},null,8,["modelValue"])]),D(de,{modelValue:t.value,"onUpdate:modelValue":n[1]||(n[1]=u=>t.value=u),showIssueSection:r.value,onNext:n[2]||(n[2]=u=>r.value=!0)},null,8,["modelValue","showIssueSection"]),D(je,{readAll:m.value,"onUpdate:readAll":n[3]||(n[3]=u=>m.value=u),haveAll:s.value,"onUpdate:haveAll":n[4]||(n[4]=u=>s.value=u),showIssueSection:r.value,seriesData:t.value,issues:o.value,imagesrc:b.value,onCancel:n[5]||(n[5]=u=>r.value=!1),onSubmit:a},null,8,["readAll","haveAll","showIssueSection","seriesData","issues","imagesrc"])]))}}),Re=q(Be,[["__scopeId","data-v-2389799a"]]);export{Re as default};
